<aside class="app-sidebar" style="width:260px; position:fixed; left:0; top:0; bottom:0; background:linear-gradient(180deg, #0b2745 0%, #0f3a5f 100%); color:#fff; padding:20px; overflow-y:auto; box-shadow: 2px 0 10px rgba(0,0,0,0.2); z-index: 1000;">
    
    <!-- Logo / T칤tulo -->
    <div style="margin-bottom:30px; font-weight:700; font-size:16px; color:#64b5f6; display:flex; align-items:center; gap:10px;">
        <span style="font-size:20px;">游늵</span>
        <span>ERP Cat치logo</span>
    </div>

    <!-- User Info Card -->
    <div style="background:rgba(255,255,255,0.1); padding:12px; border-radius:8px; margin-bottom:20px; font-size:12px; border-left:3px solid #64b5f6;">
        <div style="margin-bottom:6px; color:#bbb;">Usuario</div>
        <div style="font-weight:600; margin-bottom:6px; word-break:break-word;">{{ current_user.username if current_user else 'Invitado' }}</div>
        {% if current_user and current_user.role %}
        <div style="margin-top:6px; color:#64b5f6; font-weight:600;">{{ current_user.role.name.upper() }}</div>
        {% endif %}
    </div>

    <!-- Navigation Menu -->
    <nav style="display:flex; flex-direction:column; gap:4px;">
        
        <!-- CAT츼LOGO SECTION -->
        {% if has_permission('catalog', 'view') or current_user and current_user.es_admin %}
        <div style="font-size:11px; color:#90caf9; font-weight:600; margin-top:15px; margin-bottom:8px; padding-left:8px;">CAT츼LOGO</div>
        <a href="/" style="color:#fff; text-decoration:none; padding:10px 12px; border-radius:6px; display:flex; align-items:center; gap:8px; transition:all 0.2s; border-left:3px solid transparent;" onmouseover="this.style.background='rgba(255,255,255,0.1)'; this.style.borderColor='#64b5f6';" onmouseout="this.style.background='transparent'; this.style.borderColor='transparent';">
            <span>游</span> <span>Ver Cat치logo</span>
        </a>
        {% endif %}

        <!-- SOPORTE SECTION -->
        {% if has_permission('tickets', 'view') or current_user and current_user.es_admin %}
        <div style="font-size:11px; color:#90caf9; font-weight:600; margin-top:15px; margin-bottom:8px; padding-left:8px;">SOPORTE</div>
        <a href="/soporte" style="color:#fff; text-decoration:none; padding:10px 12px; border-radius:6px; display:flex; align-items:center; gap:8px; transition:all 0.2s; border-left:3px solid transparent;" onmouseover="this.style.background='rgba(255,255,255,0.1)'; this.style.borderColor='#64b5f6';" onmouseout="this.style.background='transparent'; this.style.borderColor='transparent';">
            <span>游댢</span> <span>Sistema de Tickets</span>
        </a>
        {% if has_permission('tickets', 'export') or current_user and current_user.es_admin %}
        <a href="/soporte" style="color:#fff; text-decoration:none; padding:10px 12px; margin-left:20px; border-radius:6px; display:flex; align-items:center; gap:8px; font-size:13px; transition:all 0.2s; border-left:3px solid transparent;" onmouseover="this.style.background='rgba(255,255,255,0.1)'; this.style.borderColor='#64b5f6';" onmouseout="this.style.background='transparent'; this.style.borderColor='transparent';">
            <span>游닌</span> <span>Exportar</span>
        </a>
        {% endif %}
        {% endif %}

        <!-- ADMINISTRACI칍N SECTION -->
        {% if has_permission('catalog', 'edit') or current_user and current_user.es_admin %}
        <div style="font-size:11px; color:#90caf9; font-weight:600; margin-top:15px; margin-bottom:8px; padding-left:8px;">ADMINISTRACI칍N</div>
        <a href="/admin" style="color:#fff; text-decoration:none; padding:10px 12px; border-radius:6px; display:flex; align-items:center; gap:8px; transition:all 0.2s; border-left:3px solid transparent;" onmouseover="this.style.background='rgba(255,255,255,0.1)'; this.style.borderColor='#64b5f6';" onmouseout="this.style.background='transparent'; this.style.borderColor='transparent';">
            <span>丘뙖잺</span> <span>Administrar</span>
        </a>
        <a href="/proveedores" style="color:#fff; text-decoration:none; padding:10px 12px; margin-left:20px; border-radius:6px; display:flex; align-items:center; gap:8px; font-size:13px; transition:all 0.2s; border-left:3px solid transparent;" onmouseover="this.style.background='rgba(255,255,255,0.1)'; this.style.borderColor='#64b5f6';" onmouseout="this.style.background='transparent'; this.style.borderColor='transparent';">
            <span>游끽</span> <span>Proveedores</span>
        </a>
        <a href="/admin/puerta" style="color:#fff; text-decoration:none; padding:10px 12px; margin-left:20px; border-radius:6px; display:flex; align-items:center; gap:8px; font-size:13px; transition:all 0.2s; border-left:3px solid transparent;" onmouseover="this.style.background='rgba(255,255,255,0.1)'; this.style.borderColor='#64b5f6';" onmouseout="this.style.background='transparent'; this.style.borderColor='transparent';">
            <span>游댏</span> <span>Puerta (Registros)</span>
        </a>
        {% endif %}

        <!-- SEPARATOR -->
        <div style="height:1px; background:rgba(255,255,255,0.1); margin:15px 0;"></div>
        <!-- CONFIGURACI칍N (solo admins) -->
        {% if current_user and current_user.es_admin %}
        <div style="font-size:11px; color:#90caf9; font-weight:600; margin-top:8px; margin-bottom:8px; padding-left:8px;">CONFIGURACI칍N</div>
        <a href="/admin/users" style="color:#fff; text-decoration:none; padding:10px 12px; border-radius:6px; display:flex; align-items:center; gap:8px; transition:all 0.2s; border-left:3px solid transparent;" onmouseover="this.style.background='rgba(255,255,255,0.1)'; this.style.borderColor='#64b5f6';" onmouseout="this.style.background='transparent'; this.style.borderColor='transparent';">
            <span>游논</span> <span>Usuarios</span>
        </a>
        <a href="/admin/puerta" style="color:#fff; text-decoration:none; padding:10px 12px; margin-left:0; border-radius:6px; display:flex; align-items:center; gap:8px; font-size:13px; transition:all 0.2s; border-left:3px solid transparent;" onmouseover="this.style.background='rgba(255,255,255,0.1)'; this.style.borderColor='#64b5f6';" onmouseout="this.style.background='transparent'; this.style.borderColor='transparent';">
            <span>游댏</span> <span>Puerta (Registros)</span>
        </a>
        {% endif %}

        <!-- PUBLIC ACTIONS -->
        <a href="/reportar" style="color:#fff; text-decoration:none; padding:10px 12px; border-radius:6px; display:flex; align-items:center; gap:8px; transition:all 0.2s; border-left:3px solid transparent; font-size:13px;" onmouseover="this.style.background='rgba(255,255,255,0.1)'; this.style.borderColor='#64b5f6';" onmouseout="this.style.background='transparent'; this.style.borderColor='transparent';">
            <span>游늶</span> <span>Reportar Incidencia</span>
        </a>

        <!-- LOGOUT -->
        <a href="{{ url_for('logout') }}" style="color:#ff7675; text-decoration:none; padding:10px 12px; border-radius:6px; display:flex; align-items:center; gap:8px; transition:all 0.2s; border-left:3px solid transparent;" onmouseover="this.style.background='rgba(255,118,118,0.1)'; this.style.borderColor='#ff7675';" onmouseout="this.style.background='transparent'; this.style.borderColor='transparent';">
            <span>游</span> <span>Cerrar Sesi칩n</span>
        </a>
    </nav>

    <!-- Footer Info -->
    <div style="position: absolute; bottom: 20px; left: 20px; right: 20px; font-size:11px; color:#90caf9; border-top:1px solid rgba(255,255,255,0.1); padding-top:12px;">
        <div style="margin-bottom:4px;">ERP v1.0</div>
        <div style="color:#64b5f6; font-weight:600;">{% if current_user %}{{ current_user.username }}{% else %}Invitado{% endif %}</div>
    </div>
</aside>

<style>
    /* Ajustar contenido principal para que no quede bajo el sidebar */
    body > .container, 
    body > .ingeniero-container,
    body > .admin-container,
    body > div > .admin-container {
        margin-left: 280px;
    }

    /* Asegurar que navbar no tenga conflictos */
    .navbar {
        margin-left: 280px;
    }

    /* Mobile: hide sidebar on small screens */
    @media (max-width: 768px) {
        .app-sidebar {
            display: none;
        }
        body > .container, 
        body > .ingeniero-container,
        body > .admin-container,
        body > div > .admin-container {
            margin-left: 0;
        }
        .navbar {
            margin-left: 0;
        }
    }
</style>
